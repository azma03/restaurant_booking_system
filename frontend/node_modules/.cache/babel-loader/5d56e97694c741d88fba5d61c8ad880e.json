{"ast":null,"code":"import _classCallCheck from \"/Users/stephenhart/Documents/Documents - Stephen\\u2019s MacBook Air/Codeclan/week15/restaurant_booking_system/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/stephenhart/Documents/Documents - Stephen\\u2019s MacBook Air/Codeclan/week15/restaurant_booking_system/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/stephenhart/Documents/Documents - Stephen\\u2019s MacBook Air/Codeclan/week15/restaurant_booking_system/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/stephenhart/Documents/Documents - Stephen\\u2019s MacBook Air/Codeclan/week15/restaurant_booking_system/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/stephenhart/Documents/Documents - Stephen\\u2019s MacBook Air/Codeclan/week15/restaurant_booking_system/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/stephenhart/Documents/Documents - Stephen\\u2019s MacBook Air/Codeclan/week15/restaurant_booking_system/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/stephenhart/Documents/Documents - Stephen\\u2019s MacBook Air/Codeclan/week15/restaurant_booking_system/frontend/src/containers/TableContainer.js\";\nimport React, { Component } from 'react';\nimport TableList from '../components/Tables/TableList';\nimport TableForm from '../components/Tables/TableForm';\nimport Request from '../helpers/request';\n\nvar TableContainer =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(TableContainer, _Component);\n\n  function TableContainer(props) {\n    var _this;\n\n    _classCallCheck(this, TableContainer);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(TableContainer).call(this, props));\n    _this.state = {\n      date: \"\",\n      time: \"\",\n      partySize: \"\",\n      available: \"\",\n      data: []\n    };\n    _this.handleFormSubmit = _this.handleFormSubmit.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(TableContainer, [{\n    key: \"handleFormSubmit\",\n    value: function handleFormSubmit(partySize, date, time) {\n      this.setState({\n        partySize: partySize,\n        date: date,\n        time: time\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var request = new Request();\n      request.get('/api/booths').then(function (data) {\n        _this2.setState({\n          data: data._embedded.booths\n        });\n      });\n    }\n  }, {\n    key: \"getAllBookings\",\n    value: function getAllBookings() {\n      var _this3 = this;\n\n      var requests = [];\n\n      for (var i = 1; i < 7; i++) {\n        var request = new Request();\n        requests.push(request.get(\"/api/booths/\".concat(i, \"/bookings\")));\n      }\n\n      Promise.all(requests).then(function (responses) {\n        for (var _i = 0; _i < responses.length; _i++) {\n          var tableMatch = void 0;\n\n          if (responses[_i]._embedded.bookings.length > 0) {\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n              for (var _iterator = responses[_i]._embedded.bookings[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                var booking = _step.value;\n\n                if (booking.booth.capacity < _this3.state.partySize) {\n                  tableMatch.push(1);\n\n                  _this3.setState({\n                    available: true\n                  });\n                }\n\n                if (booking.date === _this3.state.date & booking.timeSlot === _this3.state.time) {\n                  tableMatch.push(1);\n                }\n              }\n            } catch (err) {\n              _didIteratorError = true;\n              _iteratorError = err;\n            } finally {\n              try {\n                if (!_iteratorNormalCompletion && _iterator.return != null) {\n                  _iterator.return();\n                }\n              } finally {\n                if (_didIteratorError) {\n                  throw _iteratorError;\n                }\n              }\n            }\n          }\n\n          if (tableMatch.length > 0) {\n            // http://localhost:8080/toggle_booth_availability/4\n            _this3.setState({\n              available: false\n            });\n          } else {\n            _this3.setState({\n              available: true\n            });\n          }\n        }\n\n        ;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(React.Fragment, null, React.createElement(TableForm, {\n        onFormSubmit: this.handleFormSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }), React.createElement(TableList, {\n        data: this.state.data,\n        available: this.state.available,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return TableContainer;\n}(Component);\n\n;\nexport default TableContainer;","map":{"version":3,"sources":["/Users/stephenhart/Documents/Documents - Stephenâ€™s MacBook Air/Codeclan/week15/restaurant_booking_system/frontend/src/containers/TableContainer.js"],"names":["React","Component","TableList","TableForm","Request","TableContainer","props","state","date","time","partySize","available","data","handleFormSubmit","bind","setState","request","get","then","_embedded","booths","requests","i","push","Promise","all","responses","length","tableMatch","bookings","booking","booth","capacity","timeSlot"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,OAAOC,SAAP,MAAsB,gCAAtB;AACA,OAAOC,SAAP,MAAsB,gCAAtB;AACA,OAAOC,OAAP,MAAoB,oBAApB;;IAGMC,c;;;;;AACJ,0BAAYC,KAAZ,EAAkB;AAAA;;AAAA;;AAChB,wFAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AACXC,MAAAA,IAAI,EAAE,EADK;AAEXC,MAAAA,IAAI,EAAE,EAFK;AAGXC,MAAAA,SAAS,EAAE,EAHA;AAIXC,MAAAA,SAAS,EAAC,EAJC;AAKXC,MAAAA,IAAI,EAAC;AALM,KAAb;AAOA,UAAKC,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBC,IAAtB,uDAAxB;AATgB;AAUjB;;;;qCAEgBJ,S,EAAWF,I,EAAMC,I,EAAK;AACvC,WAAKM,QAAL,CAAc;AAACL,QAAAA,SAAS,EAAEA,SAAZ;AAAuBF,QAAAA,IAAI,EAAEA,IAA7B;AAAmCC,QAAAA,IAAI,EAACA;AAAxC,OAAd;AACD;;;wCAEkB;AAAA;;AAChB,UAAIO,OAAO,GAAG,IAAIZ,OAAJ,EAAd;AACAY,MAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BC,IAA3B,CAAgC,UAACN,IAAD,EAAU;AACxC,QAAA,MAAI,CAACG,QAAL,CAAc;AAACH,UAAAA,IAAI,EAAEA,IAAI,CAACO,SAAL,CAAeC;AAAtB,SAAd;AACD,OAFD;AAGD;;;qCAEc;AAAA;;AACd,UAAIC,QAAQ,GAAG,EAAf;;AACA,WAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,CAAnB,EAAsBA,CAAC,EAAvB,EAA0B;AACxB,YAAIN,OAAO,GAAG,IAAIZ,OAAJ,EAAd;AACAiB,QAAAA,QAAQ,CAACE,IAAT,CAAcP,OAAO,CAACC,GAAR,uBAA2BK,CAA3B,eAAd;AACD;;AACDE,MAAAA,OAAO,CAACC,GAAR,CAAYJ,QAAZ,EAAsBH,IAAtB,CAA2B,UAAAQ,SAAS,EAAI;AAGtC,aAAI,IAAIJ,EAAC,GAAG,CAAZ,EAAeA,EAAC,GAAGI,SAAS,CAACC,MAA7B,EAAqCL,EAAC,EAAtC,EAAyC;AACvC,cAAIM,UAAU,SAAd;;AAEC,cAAGF,SAAS,CAACJ,EAAD,CAAT,CAAaH,SAAb,CAAuBU,QAAvB,CAAgCF,MAAhC,GAAuC,CAA1C,EAA4C;AAAA;AAAA;AAAA;;AAAA;AAC3C,mCAAoBD,SAAS,CAACJ,EAAD,CAAT,CAAaH,SAAb,CAAuBU,QAA3C,8HAAoD;AAAA,oBAA3CC,OAA2C;;AAClD,oBAAGA,OAAO,CAACC,KAAR,CAAcC,QAAd,GAAyB,MAAI,CAACzB,KAAL,CAAWG,SAAvC,EAAiD;AACjDkB,kBAAAA,UAAU,CAACL,IAAX,CAAgB,CAAhB;;AACA,kBAAA,MAAI,CAACR,QAAL,CAAc;AAACJ,oBAAAA,SAAS,EAAE;AAAZ,mBAAd;AACD;;AAED,oBAAImB,OAAO,CAACtB,IAAR,KAAiB,MAAI,CAACD,KAAL,CAAWC,IAA7B,GAAsCsB,OAAO,CAACG,QAAR,KAAqB,MAAI,CAAC1B,KAAL,CAAWE,IAAzE,EAA+E;AAC3EmB,kBAAAA,UAAU,CAACL,IAAX,CAAgB,CAAhB;AACD;AACF;AAV0C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAW5C;;AAED,cAAGK,UAAU,CAACD,MAAX,GAAoB,CAAvB,EAAyB;AACvB;AACA,YAAA,MAAI,CAACZ,QAAL,CAAc;AAACJ,cAAAA,SAAS,EAAE;AAAZ,aAAd;AACD,WAHD,MAGK;AACL,YAAA,MAAI,CAACI,QAAL,CAAc;AAACJ,cAAAA,SAAS,EAAE;AAAZ,aAAd;AACD;AAEA;;AAAA;AACF,OA3BD;AA4BD;;;6BAES;AACN,aACE,0CACA,oBAAC,SAAD;AAAW,QAAA,YAAY,EAAI,KAAKE,gBAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADA,EAGA,oBAAC,SAAD;AAAW,QAAA,IAAI,EAAE,KAAKN,KAAL,CAAWK,IAA5B;AAAkC,QAAA,SAAS,EAAE,KAAKL,KAAL,CAAWI,SAAxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHA,CADF;AAOD;;;;EApE0BV,S;;AAqE5B;AAGD,eAAeI,cAAf","sourcesContent":["import React, {Component} from 'react';\nimport TableList from '../components/Tables/TableList';\nimport TableForm from '../components/Tables/TableForm';\nimport Request from '../helpers/request';\n\n\nclass TableContainer extends Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      date: \"\",\n      time: \"\",\n      partySize: \"\",\n      available:\"\",\n      data:[]\n    };\n    this.handleFormSubmit = this.handleFormSubmit.bind(this);\n  };\n\n  handleFormSubmit(partySize, date, time){\n  this.setState({partySize: partySize, date: date, time:time});\n};\n\ncomponentDidMount(){\n   let request = new Request()\n   request.get('/api/booths').then((data) => {\n     this.setState({data: data._embedded.booths});\n   })\n }\n\ngetAllBookings(){\n  let requests = [];\n  for(let i = 1; i < 7; i++){\n    let request = new Request();\n    requests.push(request.get(`/api/booths/${i}/bookings`))\n  }\n  Promise.all(requests).then(responses => {\n\n\n    for(let i = 0; i < responses.length; i++){\n      let tableMatch;\n\n       if(responses[i]._embedded.bookings.length>0){\n        for (var booking of responses[i]._embedded.bookings){\n          if(booking.booth.capacity < this.state.partySize){\n          tableMatch.push(1)\n          this.setState({available: true})\n        }\n\n        if((booking.date === this.state.date) & (booking.timeSlot === this.state.time)){\n            tableMatch.push(1)\n          }\n        }\n      }\n\n      if(tableMatch.length > 0){\n        // http://localhost:8080/toggle_booth_availability/4\n        this.setState({available: false});\n      }else{\n      this.setState({available: true});\n    }\n\n    };\n  });\n};\n\n  render(){\n    return(\n      <>\n      <TableForm onFormSubmit = {this.handleFormSubmit}/>\n\n      <TableList data={this.state.data} available={this.state.available}/>\n      </>\n    );\n  };\n};\n\n\nexport default TableContainer;\n"]},"metadata":{},"sourceType":"module"}